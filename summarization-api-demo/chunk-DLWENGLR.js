import{a as A}from"./chunk-IG6KZ4J4.js";import{C as v,Da as j,F as y,G as f,L as C,M as s,N as u,O as w,T as M,V as _,X as z,Y as b,Z as S,_ as k,aa as D,ba as N,ca as R,g as o,ha as g,i as d,j as p,ja as E,ka as V,la as T,ma as P,n as m,oa as q,v as r,wa as I,xa as L,y as h,ya as Q,za as W}from"./chunk-TLBTZREK.js";var H=["answer"];function O(i,e){i&1&&w(0,"div",null,0)}var F=class i{summarizationService=o(I);parserService=o(A);renderer=o(h);content=P.required();options=V.required();answer=T.required("answer");element=g(()=>this.answer().nativeElement);error=m("");isSummarizing=m(!1);chunk=m({value:""});chunkResource=E({stream:async()=>this.chunk});chunkValue=g(()=>this.chunkResource.hasValue()?this.chunkResource.value():void 0);processSummary=this.summarizationService.createChunkReader();constructor(){q({write:()=>{let e=this.chunkValue();e&&this.parserService.writeToElement(e)}})}async requestSummary(){try{this.isSummarizing.set(!0),this.chunk.set({value:""}),this.clearSummary();let e=await this.summarizationService.createSummarizer(this.options());e&&await this.processSummary({summarizer:e,content:this.content().trim(),chunk:this.chunk,isSummarizing:this.isSummarizing})}catch(e){console.error(e),this.error.set("Error in streaming the summary.")}}clearSummary(){let e=this.element();e.lastChild&&this.renderer.setProperty(e,"innerHTML",""),this.parserService.resetParser(e)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=v({type:i,selectors:[["app-stream-summary"]],viewQuery:function(n,t){n&1&&z(t.answer,H,5),n&2&&b()},inputs:{content:[1,"content"],options:[1,"options"]},outputs:{content:"contentChange"},decls:7,vars:4,consts:[["answer",""],["for","content"],["id","content","name","content","rows","20",3,"ngModelChange","ngModel"],[3,"click","disabled"]],template:function(n,t){if(n&1){let a=M();s(0,"label",1),S(1,"Content:"),u(),s(2,"textarea",2),R("ngModelChange",function(l){return d(a),N(t.content,l)||(t.content=l),p(l)}),u(),s(3,"div")(4,"button",3),_("click",function(){return d(a),p(t.requestSummary())}),S(5),u()(),y(6,O,2,0,"div")}if(n&2){r(2),D("ngModel",t.content);let a=t.isSummarizing()?"Summarizing...":"Summarize",c=t.content().trim()===""||t.isSummarizing();r(2),C("disabled",c),r(),k(a),r(),f(t.error()?-1:6)}},dependencies:[j,L,Q,W],styles:["input[_ngcontent-%COMP%]{width:100%}"],changeDetection:0})};export{F as StreamSummaryComponent};
